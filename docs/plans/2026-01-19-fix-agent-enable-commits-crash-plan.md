# 计划：修复 agent --enable-commits 崩溃

- 时间: 2026-01-19
- 状态: [done]

## 技术方案
- 通过 CLI 入口定位 agent 子命令对 --enable-commits 的处理路径
- 复现崩溃并抓取堆栈/日志，定位异常触发点
- 修复参数解析/运行时依赖的空指针或不一致状态
- 添加最小化验证（测试或脚本）覆盖崩溃路径

## 详细步骤
1. 读取 CLI 入口与 agent 子命令实现，确认参数流向
2. 本地复现崩溃并记录堆栈
3. 对照实现与堆栈定位根因
4. 实施修复并更新相关逻辑
5. 添加验证并运行质量门禁
6. 更新任务与交接记录

## 时间预估
- 复现与定位: 0.5 天
- 修复与验证: 0.5 天

## 风险评估
- 崩溃由隐藏的并发/状态依赖触发，复现不稳定
- 修复可能影响提交功能的默认行为
